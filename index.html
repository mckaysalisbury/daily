<!DOCTYPE html>
<html>
    <head>
        <title>McKay's Shirts</title>
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css"/>
        <script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
        <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
        <script>
            function clean(row) {
                row.dates.sort()
                row.recentDate = row.dates[row.dates.length - 1];
                return row
            }
            const columns = [
                'name', 'text', 'recentDate',
            ]
            // https://www.datatables.net/examples/ajax/objects.html
            $(document).ready(function() {
                $('#shirts').DataTable({
                    ajax: {
                        url: "shirts.json",
                        dataSrc: (response) => response.data.map(clean),
                    },
                    rowId: 'id',
                    columns: columns.map((name) => { return {'data': name}}),
                    // 'columnDefs': [
                    //     { targets: 0, render: function(data, type, row){
                    //         return `<img src='${data}' width='250px'/>`;
                    //     }}
                    // ],
                    createdRow: function(row, data, dataIndex) {
                        $(row).click(() => document.location = `shirt.html?id=${row.id}`);
                    },
                    order: [[2, 'desc']]
                });
            })
        </script>
    </head>
    <body>
        <table id="shirts">
            <thead id="shirtsHead">
            </thead>
        </table>
        <script>
            $('#shirtsHead').html(''.concat(columns.map((name) => `<th>${name}</th>`)));
        </script>
    </body>
</html>